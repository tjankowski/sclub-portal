<% last_articles =  Article.find_all_by_published(true, :limit => 3, :order => "created_at DESC") %>

<div>
  <table id="articles_viewer" cellpadding="0" cellspacing="0">
    <tr>
      <td>
        <% for article in last_articles do %>
            <% if last_articles.first == article %>
              <div class="photo">
                <%  if  article.galleries.last.has_main_photo? %>
                  <%= image_tag article.galleries.last.main_photo.view.url(:big), :size=>"600x400" %>
                <% else %>
                  <%= image_tag article.galleries.last.photos.last.view.url(:big), :size=>"600x400" %>
                <% end %>
              </div>
            <% else %>
              <div class="hidden_photo">
                <% if article.galleries.last.has_main_photo? %>
                  <%= image_tag article.galleries.last.main_photo.view.url(:big), :size=>"600x400" %>
                <% else %>
                  <%= image_tag article.galleries.last.photos.last.view.url(:big), :size=>"600x400" %>
                <% end %>
              </div>
            <% end %>
          <% end %>
        </td>
        <td class="text_wrapper">
          <table cellpadding="0" cellspacing="0" width="100%" height="100%">
            <% for article in last_articles do %>  
                <tr id="text_wrapper_<%= last_articles.index(article) %>" >
                   <% if last_articles.first == article %>
                  <td class="articles_viewer_text_hover">
                    <%= h  article.summary_sentence %>
                  </td>
                   <% else %>
                  <td class="articles_viewer_text">
                    <%= h  article.summary_sentence %>
                  </td>
                  <% end %>
                </tr>
              <% end %>
            </table>
          </td>
        </tr>
      </table>
    </div>